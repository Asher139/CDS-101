---
title: "Assignment 7: Who busts the Mythbusters?"
author: MinJae Jo
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(infer))
set.seed(42)
# Load dataset
experimental_data <- read_csv("yawn.csv")
```

## Exercise 1

-Explanatory variable: group (Control vs. Treatment)

-Response variable: yawn (yes/no)

-Success: yawn = yes


## Exercise 2

-iv. The difference in proportions of yawns between the treatment and control groups


## Exercise 3

```{r, echo=FALSE, message=FALSE, warning=FALSE}
experimental_data %>%
  specify(yawn ~ group, success = "yes") %>%
  head()
```


## Exercise 4

```{r, echo=FALSE, message=FALSE, warning=FALSE}
experimental_data %>%
  specify(yawn ~ group, success = "yes") %>%
  hypothesize(null = "independence") %>%
  head()
```

## Exercise 5
```{r, echo=FALSE, message=FALSE, warning=FALSE}
experimental_data %>%
  specify(yawn ~ group, success = "yes") %>%
  hypothesize(null = "independence") %>%
  generate(reps = 10000, type = "permute") %>%
  head()
```
## Exercise 6
```{r, echo=FALSE, message=FALSE, warning=FALSE}
experimental_data %>%
  specify(yawn ~ group, success = "yes") %>%
  hypothesize(null = "independence") %>%
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in props", order = c("Treatment", "Control")) %>%
  head()
```

## Exercise 7
```{r, echo=FALSE, message=FALSE, warning=FALSE}
yawn_null <- experimental_data %>%
  specify(yawn ~ group, success = "yes") %>%
  hypothesize(null = "independence") %>%
  generate(reps = 10000, type = "permute") %>%
  calculate(stat = "diff in props", order = c("Treatment", "Control"))
  head(yawn_null)
```


## Exercise 8

-(i) Histogram of the null distribution ggplot(yawn_null, aes(x = stat)) + geom_histogram(bins = 30)
-(ii) Density plot ggplot(yawn_null, aes(x = stat)) + geom_density()
-(iii) Density plot with smoothing ggplot(yawn_null, aes(x = stat)) + geom_density(adjust = 5)

## Exercise 9
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)

ggplot(data = yawn_null, aes(x = stat)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "lightblue", color = "black") +
  geom_density(color = "red", adjust = 2)

```


## Exercise 10

```{r, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = yawn_null, aes(x = stat)) +
  geom_histogram(aes(y = ..density..), bins = 30, 
                 fill = "lightblue", color = "black") +
  geom_density(color = "red", adjust = 2)
```


## Exercise 11




## Academic Integrity statement
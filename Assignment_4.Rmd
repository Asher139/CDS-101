---
title: "Assignment 4: Capital Bikeshare"
author: "MinJae Jo"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE, echo=FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(geosphere))
bikeshare <- readRDS("bikeshare_data.RDS")
```


## Exercise 1

**(i) Continuous variables:** start_lat, start_lng  
**(ii) Categorical variables:** rideable_type, member_casual  
**(iii) Each row represents:** one bikeshare trip


## Exercise 2
```{r, echo=FALSE}
bikeshare <- bikeshare %>%
  mutate(
    duration_min = as.numeric(difftime(ended_at, started_at, units = "mins"))
  )

bikeshare %>%
  summarise(
    mean_duration = mean(duration_min, na.rm = TRUE),
    min_duration = min(duration_min, na.rm = TRUE),
    max_duration = max(duration_min, na.rm = TRUE)
  )

```
## Exercise 3

```{r, echo=FALSE}
bikeshare <- bikeshare %>%
  mutate(duration_sec = as.numeric(difftime(ended_at, started_at, units = "secs")))

bikeshare %>%
  ggplot(aes(x = duration_sec)) +
  geom_histogram() +
  labs(
    title = "Distribution of Bikeshare Trip Duration",
    x = "Duration (seconds)"
  )
```


## Exercise 4

```{r ex4_boxplot, echo=FALSE, message=FALSE, warning=FALSE}
if (!"duration_min" %in% names(bikeshare)) {
  bikeshare <- bikeshare %>%
    dplyr::mutate(duration_min = as.numeric(difftime(ended_at, started_at, units = "mins")))
}

q95 <- stats::quantile(bikeshare$duration_min, 0.95, na.rm = TRUE)

bikeshare %>%
  ggplot2::ggplot(ggplot2::aes(x = "", y = duration_min)) +
  ggplot2::geom_boxplot(outlier.alpha = 0.25, width = 0.25) +
  ggplot2::coord_cartesian(ylim = c(0, q95)) +
  ggplot2::labs(
    title = "Box Plot of Bikeshare Trip Duration",
    x = NULL,
    y = "Duration (minutes)"
  )
```


## Exercise 5
```{r ex4_violin, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(bikeshare, aes(x = "", y = duration_min)) +
  geom_violin() +
  labs(
    title = "Violin Plot of Trip Duration",
    x = NULL,
    y = "Duration (minutes)"
  )
```

Violin plots show a distribution skewed to the right, similar to histograms or boxplots, for the duration of the trip. All three graphs show similar shapes and centers

## Exercise 6



## Exercise 7



## Exercise 8



## Exercise 9



## Exercise 10



## Exercise 11




## Academic Integrity statement

<--- update Thu Sep 18 11:07:49 EDT 2025 -->
